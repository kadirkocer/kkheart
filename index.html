<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Zeynep &hearts;</title>
  <meta name="description" content="Sana ozel interaktif kalp" />
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&family=Poppins:wght@300;400;600&display=swap');

    * { margin: 0; padding: 0; box-sizing: border-box; }

    :root {
      --primary: #ff2d55;
      --primary-light: #ff6b8a;
      --primary-dark: #c4002a;
      --glow: rgba(255, 45, 85, 0.4);
      --bg-dark: #0a0a1a;
      --bg-card: rgba(255, 255, 255, 0.05);
      --text: #fff;
      --text-muted: rgba(255, 255, 255, 0.6);
    }

    html, body {
      height: 100%;
      font-family: 'Poppins', sans-serif;
      background: var(--bg-dark);
      color: var(--text);
      overflow-x: hidden;
      cursor: default;
      -webkit-tap-highlight-color: transparent;
    }

    /* ========== LOADING SCREEN ========== */
    #loader {
      position: fixed;
      inset: 0;
      z-index: 9999;
      background: var(--bg-dark);
      display: grid;
      place-items: center;
      transition: opacity 0.8s, visibility 0.8s;
    }
    #loader.hide { opacity: 0; visibility: hidden; pointer-events: none; }
    .loader-heart {
      width: 80px; height: 80px;
      position: relative;
      animation: loaderBeat 1s ease-in-out infinite;
    }
    .loader-heart::before,
    .loader-heart::after {
      content: '';
      position: absolute;
      width: 80px; height: 80px;
      background: var(--primary);
      border-radius: 50% 50% 0 0;
    }
    .loader-heart::before { left: -26px; transform: rotate(-45deg); transform-origin: bottom right; }
    .loader-heart::after { left: 26px; transform: rotate(45deg); transform-origin: bottom left; }
    @keyframes loaderBeat {
      0%, 100% { transform: scale(0.9); }
      50% { transform: scale(1.1); }
    }

    /* ========== CANVAS ========== */
    #particles {
      position: fixed;
      inset: 0;
      z-index: 0;
      pointer-events: none;
    }

    /* ========== MAIN LAYOUT ========== */
    .app {
      position: relative;
      z-index: 1;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }

    /* ========== NAV ========== */
    .nav {
      width: 100%;
      max-width: 800px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px 0;
    }
    .nav-brand {
      font-family: 'Dancing Script', cursive;
      font-size: 1.8rem;
      font-weight: 700;
      background: linear-gradient(135deg, var(--primary-light), var(--primary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .nav-actions { display: flex; gap: 8px; }
    .btn-icon {
      width: 40px; height: 40px;
      border: none;
      border-radius: 50%;
      background: var(--bg-card);
      color: var(--text);
      font-size: 1.1rem;
      cursor: pointer;
      display: grid;
      place-items: center;
      transition: all 0.3s;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.08);
    }
    .btn-icon:hover { background: var(--primary); transform: scale(1.1); }
    .btn-icon.active { background: var(--primary); box-shadow: 0 0 20px var(--glow); }

    /* ========== HERO SECTION ========== */
    .hero {
      width: 100%;
      max-width: 800px;
      text-align: center;
      padding: 40px 0 20px;
    }
    .hero-subtitle {
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 4px;
      color: var(--text-muted);
      margin-bottom: 12px;
    }
    .hero-title {
      font-family: 'Dancing Script', cursive;
      font-size: clamp(2.5rem, 8vw, 4.5rem);
      font-weight: 700;
      background: linear-gradient(135deg, #ff6b8a, #ff2d55, #ff6b8a);
      background-size: 200% 200%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: gradientShift 4s ease infinite;
      margin-bottom: 8px;
    }
    @keyframes gradientShift {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    /* ========== INTERACTIVE HEART ========== */
    .heart-container {
      position: relative;
      width: 100%;
      max-width: 800px;
      display: flex;
      justify-content: center;
      padding: 30px 0;
    }

    #heartCanvas {
      cursor: pointer;
      border-radius: 20px;
      transition: filter 0.3s;
    }
    #heartCanvas:hover {
      filter: brightness(1.1);
    }

    /* ========== MESSAGE SECTION ========== */
    .message-section {
      width: 100%;
      max-width: 600px;
      text-align: center;
      padding: 20px 0;
    }
    .message-card {
      background: var(--bg-card);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 20px;
      padding: 32px 28px;
      position: relative;
      overflow: hidden;
    }
    .message-card::before {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0;
      height: 2px;
      background: linear-gradient(90deg, transparent, var(--primary), transparent);
    }
    .message-icon {
      font-size: 2rem;
      margin-bottom: 16px;
      display: block;
    }
    .message-text {
      font-family: 'Dancing Script', cursive;
      font-size: clamp(1.3rem, 4vw, 1.8rem);
      line-height: 1.6;
      color: var(--text);
      opacity: 0;
      transform: translateY(20px);
      animation: fadeInUp 1s ease forwards;
      animation-delay: 0.5s;
    }
    @keyframes fadeInUp {
      to { opacity: 1; transform: translateY(0); }
    }
    .message-author {
      margin-top: 20px;
      font-size: 0.85rem;
      color: var(--text-muted);
      letter-spacing: 2px;
    }

    /* ========== FEATURES GRID ========== */
    .features {
      width: 100%;
      max-width: 800px;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 16px;
      padding: 20px 0;
    }
    .feature-card {
      background: var(--bg-card);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255,255,255,0.06);
      border-radius: 16px;
      padding: 24px 20px;
      text-align: center;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      position: relative;
      overflow: hidden;
    }
    .feature-card::after {
      content: '';
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at var(--mx, 50%) var(--my, 50%), rgba(255,45,85,0.15), transparent 60%);
      opacity: 0;
      transition: opacity 0.3s;
    }
    .feature-card:hover::after { opacity: 1; }
    .feature-card:hover {
      transform: translateY(-4px);
      border-color: rgba(255,45,85,0.3);
      box-shadow: 0 8px 32px rgba(255,45,85,0.15);
    }
    .feature-icon { font-size: 2rem; margin-bottom: 12px; display: block; }
    .feature-title { font-weight: 600; font-size: 1rem; margin-bottom: 6px; }
    .feature-desc { font-size: 0.8rem; color: var(--text-muted); line-height: 1.5; }

    /* ========== COUNTER SECTION ========== */
    .counter-section {
      width: 100%;
      max-width: 600px;
      text-align: center;
      padding: 20px 0;
    }
    .counter-card {
      background: linear-gradient(135deg, rgba(255,45,85,0.1), rgba(255,107,138,0.05));
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255,45,85,0.2);
      border-radius: 20px;
      padding: 32px 28px;
    }
    .counter-label {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 3px;
      color: var(--text-muted);
      margin-bottom: 16px;
    }
    .counter-value {
      font-family: 'Dancing Script', cursive;
      font-size: clamp(1.8rem, 5vw, 2.5rem);
      font-weight: 700;
      color: var(--primary-light);
      margin-bottom: 8px;
    }
    .counter-clicks {
      font-size: 0.85rem;
      color: var(--text-muted);
    }
    .counter-clicks span {
      color: var(--primary-light);
      font-weight: 600;
      font-size: 1.1rem;
    }

    /* ========== COLOR PICKER ========== */
    .color-section {
      width: 100%;
      max-width: 600px;
      padding: 20px 0;
    }
    .color-card {
      background: var(--bg-card);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255,255,255,0.06);
      border-radius: 20px;
      padding: 28px;
    }
    .color-title {
      text-align: center;
      font-size: 0.9rem;
      font-weight: 600;
      margin-bottom: 20px;
    }
    .color-grid {
      display: flex;
      justify-content: center;
      gap: 12px;
      flex-wrap: wrap;
    }
    .color-btn {
      width: 44px; height: 44px;
      border-radius: 50%;
      border: 3px solid transparent;
      cursor: pointer;
      transition: all 0.3s;
      position: relative;
    }
    .color-btn:hover { transform: scale(1.2); }
    .color-btn.active {
      border-color: #fff;
      box-shadow: 0 0 20px var(--glow);
      transform: scale(1.15);
    }

    /* ========== SPEED CONTROL ========== */
    .speed-section {
      width: 100%;
      max-width: 600px;
      padding: 10px 0;
    }
    .speed-card {
      background: var(--bg-card);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255,255,255,0.06);
      border-radius: 20px;
      padding: 24px 28px;
      text-align: center;
    }
    .speed-title {
      font-size: 0.9rem;
      font-weight: 600;
      margin-bottom: 16px;
    }
    .speed-slider {
      width: 100%;
      max-width: 300px;
      -webkit-appearance: none;
      height: 6px;
      border-radius: 3px;
      background: rgba(255,255,255,0.1);
      outline: none;
      margin: 0 auto;
      display: block;
    }
    .speed-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 22px; height: 22px;
      border-radius: 50%;
      background: var(--primary);
      cursor: pointer;
      box-shadow: 0 0 10px var(--glow);
      transition: transform 0.2s;
    }
    .speed-slider::-webkit-slider-thumb:hover { transform: scale(1.2); }
    .speed-label {
      margin-top: 10px;
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    /* ========== FOOTER ========== */
    .footer {
      width: 100%;
      max-width: 800px;
      text-align: center;
      padding: 40px 0 20px;
      font-size: 0.75rem;
      color: var(--text-muted);
    }
    .footer-heart {
      display: inline-block;
      color: var(--primary);
      animation: footerBeat 1.5s ease-in-out infinite;
    }
    @keyframes footerBeat {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.3); }
    }

    /* ========== FLOATING HEARTS ========== */
    .floating-heart {
      position: fixed;
      pointer-events: none;
      z-index: 1000;
      font-size: 1.5rem;
      animation: floatUp 2s ease-out forwards;
    }
    @keyframes floatUp {
      0% { opacity: 1; transform: translateY(0) scale(1) rotate(0deg); }
      100% { opacity: 0; transform: translateY(-200px) scale(0.3) rotate(45deg); }
    }

    /* ========== CONFETTI ========== */
    .confetti-piece {
      position: fixed;
      pointer-events: none;
      z-index: 999;
      width: 8px; height: 8px;
      border-radius: 2px;
      animation: confettiFall 3s ease-out forwards;
    }
    @keyframes confettiFall {
      0% { opacity: 1; transform: translateY(0) rotate(0deg); }
      100% { opacity: 0; transform: translateY(100vh) rotate(720deg); }
    }

    /* ========== FIREWORK ========== */
    .firework-particle {
      position: fixed;
      pointer-events: none;
      z-index: 998;
      width: 4px; height: 4px;
      border-radius: 50%;
      animation: fireworkBurst 1.5s ease-out forwards;
    }
    @keyframes fireworkBurst {
      0% { opacity: 1; transform: translate(0, 0) scale(1); }
      100% { opacity: 0; transform: translate(var(--tx), var(--ty)) scale(0); }
    }

    /* ========== TOAST ========== */
    .toast {
      position: fixed;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%) translateY(100px);
      background: rgba(255,45,85,0.9);
      backdrop-filter: blur(20px);
      color: #fff;
      padding: 12px 24px;
      border-radius: 30px;
      font-size: 0.85rem;
      z-index: 10000;
      transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
      white-space: nowrap;
    }
    .toast.show { transform: translateX(-50%) translateY(0); }

    /* ========== RESPONSIVE ========== */
    @media (max-width: 480px) {
      .features { grid-template-columns: 1fr 1fr; gap: 10px; }
      .feature-card { padding: 18px 14px; }
      .message-card { padding: 24px 20px; }
    }

    /* ========== ACCESSIBILITY ========== */
    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        transition-duration: 0.01ms !important;
      }
    }

    /* ========== SCROLLBAR ========== */
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: rgba(255,45,85,0.3); border-radius: 3px; }
    ::-webkit-scrollbar-thumb:hover { background: rgba(255,45,85,0.5); }
  </style>
</head>
<body>
  <!-- Loader -->
  <div id="loader"><div class="loader-heart"></div></div>

  <!-- Background Particles -->
  <canvas id="particles"></canvas>

  <!-- Toast -->
  <div class="toast" id="toast"></div>

  <!-- App -->
  <div class="app">
    <!-- Nav -->
    <nav class="nav">
      <div class="nav-brand">kkheart</div>
      <div class="nav-actions">
        <button class="btn-icon" id="btnMusic" title="Muzik">&#9835;</button>
        <button class="btn-icon" id="btnFullscreen" title="Tam Ekran">&#9974;</button>
        <button class="btn-icon" id="btnConfetti" title="Konfeti">&#10024;</button>
      </div>
    </nav>

    <!-- Hero -->
    <section class="hero">
      <div class="hero-subtitle">sonsuz sevgiyle</div>
      <h1 class="hero-title">Zeynep</h1>
    </section>

    <!-- Interactive Heart Canvas -->
    <section class="heart-container">
      <canvas id="heartCanvas" width="400" height="380"></canvas>
    </section>

    <!-- Message -->
    <section class="message-section">
      <div class="message-card">
        <span class="message-icon">&hearts;</span>
        <p class="message-text" id="messageText"></p>
        <div class="message-author">- senden sana -</div>
      </div>
    </section>

    <!-- Features -->
    <section class="features">
      <div class="feature-card" data-action="rain">
        <span class="feature-icon">&#127783;&#65039;</span>
        <div class="feature-title">Kalp Yagmuru</div>
        <div class="feature-desc">Ekrani kalplerle doldur</div>
      </div>
      <div class="feature-card" data-action="firework">
        <span class="feature-icon">&#127878;</span>
        <div class="feature-title">Havai Fisek</div>
        <div class="feature-desc">Gokyuzunu aydinlat</div>
      </div>
      <div class="feature-card" data-action="message">
        <span class="feature-icon">&#128140;</span>
        <div class="feature-title">Yeni Mesaj</div>
        <div class="feature-desc">Rastgele sevgi mesaji</div>
      </div>
      <div class="feature-card" data-action="shake">
        <span class="feature-icon">&#128171;</span>
        <div class="feature-title">Kalp Atisi</div>
        <div class="feature-desc">Kalbi heyecanlandir</div>
      </div>
      <div class="feature-card" data-action="trail">
        <span class="feature-icon">&#10024;</span>
        <div class="feature-title">Isiltili Iz</div>
        <div class="feature-desc">Fareyi gezdirip isilt</div>
      </div>
      <div class="feature-card" data-action="rainbow">
        <span class="feature-icon">&#127752;</span>
        <div class="feature-title">Gokkusagi</div>
        <div class="feature-desc">Renkleri degistir</div>
      </div>
    </section>

    <!-- Click Counter -->
    <section class="counter-section">
      <div class="counter-card">
        <div class="counter-label">Toplam Sevgi</div>
        <div class="counter-value" id="counterValue">0</div>
        <div class="counter-clicks">Kalbe <span id="clickCount">0</span> kez dokundun</div>
      </div>
    </section>

    <!-- Color Picker -->
    <section class="color-section">
      <div class="color-card">
        <div class="color-title">Kalp Rengi Sec</div>
        <div class="color-grid" id="colorGrid"></div>
      </div>
    </section>

    <!-- Speed Control -->
    <section class="speed-section">
      <div class="speed-card">
        <div class="speed-title">Kalp Atisi Hizi</div>
        <input type="range" class="speed-slider" id="speedSlider" min="30" max="120" value="72" />
        <div class="speed-label"><span id="bpmValue">72</span> BPM</div>
      </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
      sonsuz sevgiyle yapildi <span class="footer-heart">&hearts;</span>
    </footer>
  </div>

  <script>
    // ==================== CONFIG ====================
    const COLORS = [
      { name: 'Klasik Kirmizi', hex: '#ff2d55', light: '#ff6b8a', dark: '#c4002a' },
      { name: 'Pembe', hex: '#ff69b4', light: '#ff9fd5', dark: '#cc3388' },
      { name: 'Mor', hex: '#a855f7', light: '#c084fc', dark: '#7c3aed' },
      { name: 'Mavi', hex: '#3b82f6', light: '#60a5fa', dark: '#1d4ed8' },
      { name: 'Turkuaz', hex: '#06b6d4', light: '#22d3ee', dark: '#0891b2' },
      { name: 'Yesil', hex: '#10b981', light: '#34d399', dark: '#059669' },
      { name: 'Turuncu', hex: '#f97316', light: '#fb923c', dark: '#ea580c' },
      { name: 'Altin', hex: '#eab308', light: '#facc15', dark: '#ca8a04' },
    ];

    const MESSAGES = [
      "Her atisimda senin icin atiyorum...",
      "Seni sevmek, nefes almak gibi...",
      "Dunyada en guzel sey seninle olmak...",
      "Kalbim sadece senin icin atiyor...",
      "Sen benim en guzel hikayemsin...",
      "Seninle her an bir mucize...",
      "Gozlerinde kaybolmak istiyorum...",
      "Sen olmadan hicbir sey anlam ifade etmez...",
      "Sonsuzluga kadar seninle...",
      "Sen benim hereyimsin...",
      "Sevgin hayatima anlam katiyor...",
      "Seninle her gun bayram...",
      "Yildizlar bile seni kiskanir...",
      "Kainatın en guzel hediyesisin...",
      "Sana olan askım sonsuzdur...",
    ];

    // ==================== STATE ====================
    let currentColor = COLORS[0];
    let clickCount = parseInt(localStorage.getItem('kkheart_clicks') || '0');
    let heartBPM = 72;
    let heartPhase = 0;
    let isRainbow = false;
    let rainbowHue = 0;
    let trailMode = false;
    let musicPlaying = false;
    let audioCtx = null;

    // ==================== LOADER ====================
    window.addEventListener('load', () => {
      setTimeout(() => document.getElementById('loader').classList.add('hide'), 800);
    });

    // ==================== PARTICLES BACKGROUND ====================
    const pCanvas = document.getElementById('particles');
    const pCtx = pCanvas.getContext('2d');
    let particles = [];

    function resizeParticles() {
      pCanvas.width = window.innerWidth;
      pCanvas.height = window.innerHeight;
    }
    resizeParticles();
    window.addEventListener('resize', resizeParticles);

    class Particle {
      constructor() { this.reset(); }
      reset() {
        this.x = Math.random() * pCanvas.width;
        this.y = Math.random() * pCanvas.height;
        this.size = Math.random() * 2 + 0.5;
        this.speedY = -(Math.random() * 0.3 + 0.1);
        this.speedX = (Math.random() - 0.5) * 0.2;
        this.opacity = Math.random() * 0.5 + 0.1;
        this.fadeSpeed = Math.random() * 0.005 + 0.002;
        this.growing = Math.random() > 0.5;
      }
      update() {
        this.x += this.speedX;
        this.y += this.speedY;
        this.opacity += this.growing ? this.fadeSpeed : -this.fadeSpeed;
        if (this.opacity >= 0.6) this.growing = false;
        if (this.opacity <= 0.05) this.growing = true;
        if (this.y < -10 || this.x < -10 || this.x > pCanvas.width + 10) this.reset();
      }
      draw() {
        pCtx.beginPath();
        pCtx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
        pCtx.fillStyle = `rgba(255, 45, 85, ${this.opacity})`;
        pCtx.fill();
      }
    }

    for (let i = 0; i < 60; i++) particles.push(new Particle());

    function animateParticles() {
      pCtx.clearRect(0, 0, pCanvas.width, pCanvas.height);
      particles.forEach(p => { p.update(); p.draw(); });
      requestAnimationFrame(animateParticles);
    }
    animateParticles();

    // ==================== HEART CANVAS ====================
    const hCanvas = document.getElementById('heartCanvas');
    const hCtx = hCanvas.getContext('2d');
    let heartScale = 1;
    let heartGlow = 0;
    let heartShake = 0;
    let heartClickAnim = 0;

    function getHeartColor() {
      if (isRainbow) {
        rainbowHue = (rainbowHue + 0.5) % 360;
        return `hsl(${rainbowHue}, 85%, 55%)`;
      }
      return currentColor.hex;
    }

    function getHeartLightColor() {
      if (isRainbow) return `hsl(${rainbowHue}, 85%, 70%)`;
      return currentColor.light;
    }

    function getHeartDarkColor() {
      if (isRainbow) return `hsl(${rainbowHue}, 85%, 35%)`;
      return currentColor.dark;
    }

    function drawHeart(cx, cy, size, color) {
      hCtx.save();
      hCtx.beginPath();
      const topY = cy - size * 0.4;
      hCtx.moveTo(cx, cy + size * 0.6);
      hCtx.bezierCurveTo(cx - size * 1.2, cy - size * 0.2, cx - size * 0.7, topY - size * 0.6, cx, topY + size * 0.1);
      hCtx.bezierCurveTo(cx + size * 0.7, topY - size * 0.6, cx + size * 1.2, cy - size * 0.2, cx, cy + size * 0.6);
      hCtx.closePath();

      const grad = hCtx.createRadialGradient(cx - size * 0.2, cy - size * 0.2, 0, cx, cy, size * 1.2);
      grad.addColorStop(0, getHeartLightColor());
      grad.addColorStop(0.5, color);
      grad.addColorStop(1, getHeartDarkColor());
      hCtx.fillStyle = grad;
      hCtx.fill();

      // Inner shine
      hCtx.beginPath();
      hCtx.ellipse(cx - size * 0.25, cy - size * 0.15, size * 0.15, size * 0.25, -0.5, 0, Math.PI * 2);
      hCtx.fillStyle = `rgba(255,255,255,0.15)`;
      hCtx.fill();

      hCtx.restore();
    }

    function drawHeartCanvas() {
      const w = hCanvas.width;
      const h = hCanvas.height;
      hCtx.clearRect(0, 0, w, h);

      // Beat animation
      const beatInterval = 60000 / heartBPM;
      heartPhase += 16;
      const beatProgress = (heartPhase % beatInterval) / beatInterval;
      const beatCurve = Math.sin(beatProgress * Math.PI * 2);
      const beatScale = 1 + beatCurve * 0.06;

      // Click animation decay
      heartClickAnim *= 0.92;
      heartShake *= 0.9;

      const totalScale = beatScale + heartClickAnim;
      const cx = w / 2 + Math.sin(heartShake) * heartShake * 2;
      const cy = h / 2 + 10;
      const size = 130 * totalScale;

      // Glow
      heartGlow = 0.2 + beatCurve * 0.15 + heartClickAnim * 0.5;
      hCtx.save();
      hCtx.shadowColor = getHeartColor();
      hCtx.shadowBlur = 40 * heartGlow;
      drawHeart(cx, cy, size, getHeartColor());
      hCtx.restore();

      // Outer glow ring
      hCtx.save();
      hCtx.globalAlpha = heartGlow * 0.3;
      drawHeart(cx, cy, size * 1.08, getHeartColor());
      hCtx.restore();

      requestAnimationFrame(drawHeartCanvas);
    }

    // Retina support
    function setupCanvasHiDPI(canvas, w, h) {
      const dpr = window.devicePixelRatio || 1;
      canvas.width = w * dpr;
      canvas.height = h * dpr;
      canvas.style.width = w + 'px';
      canvas.style.height = h + 'px';
      canvas.getContext('2d').scale(dpr, dpr);
    }

    function resizeHeartCanvas() {
      const size = Math.min(400, window.innerWidth - 40);
      setupCanvasHiDPI(hCanvas, size, size * 0.95);
    }
    resizeHeartCanvas();
    window.addEventListener('resize', resizeHeartCanvas);

    drawHeartCanvas();

    // ==================== HEART CLICK ====================
    hCanvas.addEventListener('click', (e) => {
      clickCount++;
      localStorage.setItem('kkheart_clicks', clickCount);
      updateCounter();
      heartClickAnim = 0.15;

      // Floating hearts
      const rect = hCanvas.getBoundingClientRect();
      for (let i = 0; i < 5; i++) {
        createFloatingHeart(e.clientX + (Math.random() - 0.5) * 40, e.clientY - 10);
      }

      // Haptic-like visual
      hCanvas.style.filter = 'brightness(1.3)';
      setTimeout(() => hCanvas.style.filter = '', 150);
    });

    function updateCounter() {
      document.getElementById('clickCount').textContent = clickCount;
      const loveLevel = clickCount < 10 ? 'Yeni Basliyor' :
                        clickCount < 50 ? 'Sevgi Buyuyor' :
                        clickCount < 100 ? 'Ask Alevi' :
                        clickCount < 500 ? 'Sonsuz Ask' :
                        clickCount < 1000 ? 'Galaktik Sevgi' : 'Efsanevi Ask';
      document.getElementById('counterValue').textContent = loveLevel;
    }
    updateCounter();

    // ==================== FLOATING HEARTS ====================
    function createFloatingHeart(x, y) {
      const el = document.createElement('div');
      el.className = 'floating-heart';
      el.innerHTML = ['&#10084;&#65039;', '&#128151;', '&#128153;', '&#128156;', '&#129505;'][Math.floor(Math.random() * 5)];
      el.style.left = x + 'px';
      el.style.top = y + 'px';
      el.style.fontSize = (Math.random() * 1.5 + 1) + 'rem';
      document.body.appendChild(el);
      setTimeout(() => el.remove(), 2000);
    }

    // ==================== MESSAGES ====================
    let currentMsgIdx = 0;
    function showMessage() {
      currentMsgIdx = (currentMsgIdx + 1) % MESSAGES.length;
      const el = document.getElementById('messageText');
      el.style.animation = 'none';
      el.offsetHeight; // reflow
      el.textContent = MESSAGES[currentMsgIdx];
      el.style.animation = 'fadeInUp 0.8s ease forwards';
    }
    document.getElementById('messageText').textContent = MESSAGES[0];

    // ==================== FEATURE CARDS ====================
    document.querySelectorAll('.feature-card').forEach(card => {
      // Mouse glow
      card.addEventListener('mousemove', e => {
        const rect = card.getBoundingClientRect();
        card.style.setProperty('--mx', ((e.clientX - rect.left) / rect.width * 100) + '%');
        card.style.setProperty('--my', ((e.clientY - rect.top) / rect.height * 100) + '%');
      });

      card.addEventListener('click', () => {
        const action = card.dataset.action;
        switch(action) {
          case 'rain': heartRain(); break;
          case 'firework': doFirework(); break;
          case 'message': showMessage(); break;
          case 'shake': doShake(); break;
          case 'trail': toggleTrail(); break;
          case 'rainbow': toggleRainbow(); break;
        }
      });
    });

    // ==================== HEART RAIN ====================
    function heartRain() {
      showToast('Kalp yagmuru basliyor!');
      for (let i = 0; i < 40; i++) {
        setTimeout(() => {
          createFloatingHeart(
            Math.random() * window.innerWidth,
            window.innerHeight + 20
          );
        }, i * 80);
      }
    }

    // ==================== FIREWORK ====================
    function doFirework() {
      showToast('Havai fisek!');
      const cx = window.innerWidth / 2;
      const cy = window.innerHeight / 3;
      const colors = ['#ff2d55', '#ff6b8a', '#ffcc00', '#ff69b4', '#a855f7', '#3b82f6'];
      for (let i = 0; i < 50; i++) {
        const angle = (Math.PI * 2 / 50) * i;
        const dist = 80 + Math.random() * 120;
        const el = document.createElement('div');
        el.className = 'firework-particle';
        el.style.left = cx + 'px';
        el.style.top = cy + 'px';
        el.style.background = colors[Math.floor(Math.random() * colors.length)];
        el.style.setProperty('--tx', Math.cos(angle) * dist + 'px');
        el.style.setProperty('--ty', Math.sin(angle) * dist + 'px');
        el.style.width = (3 + Math.random() * 4) + 'px';
        el.style.height = el.style.width;
        document.body.appendChild(el);
        setTimeout(() => el.remove(), 1500);
      }
    }

    // ==================== SHAKE ====================
    function doShake() {
      heartShake = 15;
      heartClickAnim = 0.25;
      showToast('Kalp heyecanlandi!');
      for (let i = 0; i < 8; i++) {
        const rect = hCanvas.getBoundingClientRect();
        createFloatingHeart(
          rect.left + rect.width / 2 + (Math.random() - 0.5) * 100,
          rect.top + rect.height / 2
        );
      }
    }

    // ==================== TRAIL ====================
    function toggleTrail() {
      trailMode = !trailMode;
      showToast(trailMode ? 'Isiltili iz aktif!' : 'Isiltili iz kapatildi');
    }

    document.addEventListener('mousemove', (e) => {
      if (!trailMode) return;
      if (Math.random() > 0.3) return;
      const spark = document.createElement('div');
      spark.className = 'firework-particle';
      spark.style.left = e.clientX + 'px';
      spark.style.top = e.clientY + 'px';
      spark.style.background = getHeartColor();
      spark.style.setProperty('--tx', (Math.random() - 0.5) * 30 + 'px');
      spark.style.setProperty('--ty', (Math.random() - 0.5) * 30 + 'px');
      spark.style.width = '5px';
      spark.style.height = '5px';
      document.body.appendChild(spark);
      setTimeout(() => spark.remove(), 1500);
    });

    // ==================== RAINBOW ====================
    function toggleRainbow() {
      isRainbow = !isRainbow;
      showToast(isRainbow ? 'Gokkusagi modu aktif!' : 'Normal mod');
    }

    // ==================== COLOR PICKER ====================
    const colorGrid = document.getElementById('colorGrid');
    COLORS.forEach((c, i) => {
      const btn = document.createElement('button');
      btn.className = 'color-btn' + (i === 0 ? ' active' : '');
      btn.style.background = c.hex;
      btn.title = c.name;
      btn.addEventListener('click', () => {
        isRainbow = false;
        currentColor = c;
        document.querySelectorAll('.color-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        showToast(c.name + ' secildi');
      });
      colorGrid.appendChild(btn);
    });

    // ==================== SPEED SLIDER ====================
    const speedSlider = document.getElementById('speedSlider');
    const bpmValue = document.getElementById('bpmValue');
    speedSlider.addEventListener('input', () => {
      heartBPM = parseInt(speedSlider.value);
      bpmValue.textContent = heartBPM;
    });

    // ==================== CONFETTI ====================
    function doConfetti() {
      const colors = ['#ff2d55', '#ff6b8a', '#ffcc00', '#a855f7', '#3b82f6', '#10b981', '#fff'];
      for (let i = 0; i < 60; i++) {
        const el = document.createElement('div');
        el.className = 'confetti-piece';
        el.style.left = (Math.random() * 100) + 'vw';
        el.style.top = '-10px';
        el.style.background = colors[Math.floor(Math.random() * colors.length)];
        el.style.animationDelay = (Math.random() * 2) + 's';
        el.style.animationDuration = (2 + Math.random() * 2) + 's';
        el.style.width = (5 + Math.random() * 8) + 'px';
        el.style.height = (5 + Math.random() * 8) + 'px';
        document.body.appendChild(el);
        setTimeout(() => el.remove(), 5000);
      }
    }
    document.getElementById('btnConfetti').addEventListener('click', () => {
      doConfetti();
      showToast('Konfeti!');
    });

    // ==================== MUSIC ====================
    function createAudioContext() {
      if (audioCtx) return audioCtx;
      audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      return audioCtx;
    }

    let musicInterval = null;
    const MELODY = [523.25, 587.33, 659.25, 698.46, 783.99, 659.25, 523.25, 587.33, 659.25, 523.25];

    function playNote(freq, time, dur) {
      const ctx = createAudioContext();
      const osc = ctx.createOscillator();
      const gain = ctx.createGain();
      osc.type = 'sine';
      osc.frequency.value = freq;
      gain.gain.setValueAtTime(0, time);
      gain.gain.linearRampToValueAtTime(0.08, time + 0.05);
      gain.gain.linearRampToValueAtTime(0, time + dur);
      osc.connect(gain);
      gain.connect(ctx.destination);
      osc.start(time);
      osc.stop(time + dur);
    }

    function toggleMusic() {
      const btn = document.getElementById('btnMusic');
      if (musicPlaying) {
        musicPlaying = false;
        btn.classList.remove('active');
        clearInterval(musicInterval);
        showToast('Muzik durduruldu');
        return;
      }
      musicPlaying = true;
      btn.classList.add('active');
      showToast('Muzik basliyor');

      let noteIdx = 0;
      function playNext() {
        if (!musicPlaying) return;
        const ctx = createAudioContext();
        playNote(MELODY[noteIdx % MELODY.length], ctx.currentTime, 0.4);
        noteIdx++;
      }
      playNext();
      musicInterval = setInterval(playNext, 500);
    }
    document.getElementById('btnMusic').addEventListener('click', toggleMusic);

    // ==================== FULLSCREEN ====================
    document.getElementById('btnFullscreen').addEventListener('click', () => {
      if (!document.fullscreenElement) {
        document.documentElement.requestFullscreen().catch(() => {});
        showToast('Tam ekran');
      } else {
        document.exitFullscreen();
        showToast('Normal ekran');
      }
    });

    // ==================== TOAST ====================
    let toastTimeout;
    function showToast(msg) {
      const el = document.getElementById('toast');
      el.textContent = msg;
      el.classList.add('show');
      clearTimeout(toastTimeout);
      toastTimeout = setTimeout(() => el.classList.remove('show'), 2000);
    }

    // ==================== KEYBOARD SHORTCUTS ====================
    document.addEventListener('keydown', (e) => {
      switch(e.key) {
        case 'h': heartRain(); break;
        case 'f': doFirework(); break;
        case 'm': showMessage(); break;
        case 's': doShake(); break;
        case 'r': toggleRainbow(); break;
        case 'c': doConfetti(); break;
        case ' ':
          e.preventDefault();
          hCanvas.click();
          break;
      }
    });

    // ==================== CLICK ANYWHERE FOR HEARTS ====================
    document.addEventListener('click', (e) => {
      if (e.target.closest('.feature-card, .color-btn, .btn-icon, .speed-slider, #heartCanvas')) return;
      createFloatingHeart(e.clientX, e.clientY);
    });
  </script>
</body>
</html>
